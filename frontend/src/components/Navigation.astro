---
import { t, localizePath, type Locale } from '../utils/i18n';

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const currentPath = Astro.url.pathname;
const translate = (key: string) => t(locale, key);
const localPath = (path: string) => localizePath(locale, path);

const navItems = [
  { label: translate('nav.home'), href: localPath('/') },
  { label: translate('nav.about'), href: localPath('/about') },
  { label: translate('nav.programs'), href: localPath('/programs') },
  { label: translate('nav.admissions'), href: localPath('/admissions') },
  { label: translate('nav.news'), href: localPath('/news') },
  { label: translate('nav.contact'), href: localPath('/contact') },
];

const isActive = (href: string) => {
  if (href === localPath('/')) {
    return currentPath === href || currentPath === `/${locale}` || currentPath === `/${locale}/` || currentPath === '/';
  }
  return currentPath.startsWith(href);
};
---

<nav class="hidden lg:flex items-center space-x-8">
  {
    navItems.map((item) => (
      <a
        href={item.href}
        class:list={[
          'text-gray-700 hover:text-primary-500 font-medium transition-colors',
          isActive(item.href) && 'text-primary-500 border-b-2 border-primary-500',
        ]}
      >
        {item.label}
      </a>
    ))
  }
</nav>

<!-- Mobile Menu Button -->
<button
  id="mobile-menu-button"
  class="lg:hidden p-2 text-gray-700 hover:text-primary-500"
  aria-label="Toggle mobile menu"
>
  <svg
    class="w-6 h-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M4 6h16M4 12h16M4 18h16"></path>
  </svg>
</button>

<!-- Mobile Menu -->
<div
  id="mobile-menu"
  class="hidden lg:hidden absolute top-full left-0 right-0 bg-white shadow-lg border-t"
>
  <div class="px-4 py-4 space-y-4">
    {
      navItems.map((item) => (
        <a
          href={item.href}
          class:list={[
            'block text-gray-700 hover:text-primary-500 font-medium transition-colors py-2',
            isActive(item.href) && 'text-primary-500',
          ]}
        >
          {item.label}
        </a>
      ))
    }
  </div>
</div>

<script>
  const button = document.getElementById('mobile-menu-button');
  const menu = document.getElementById('mobile-menu');

  button?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
  });

  // Close menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!button?.contains(e.target as Node) && !menu?.contains(e.target as Node)) {
      menu?.classList.add('hidden');
    }
  });
</script>
